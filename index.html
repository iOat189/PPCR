<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Kanit', sans-serif;
        }
        .card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .loading {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="min-h-screen p-4">
    <div class="container mx-auto max-w-6xl px-2 md:px-4">
        <!-- Header -->
        <div class="text-center mb-6 md:mb-8">
            <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-white mb-3 md:mb-4 px-2">
                üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î üè•
            </h1>
            <p class="text-white/80 text-base md:text-lg px-4">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</p>
        </div>

        <!-- Control Panel -->
        <div class="card rounded-xl md:rounded-2xl p-4 md:p-6 mb-6 md:mb-8 shadow-2xl mx-2 md:mx-0">
            <div class="flex flex-col sm:flex-row gap-3 md:gap-4 items-center justify-center">
                <div class="flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto">
                    <label for="monthSelect" class="text-gray-700 font-medium text-sm md:text-base whitespace-nowrap">üìÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</label>
                    <select id="monthSelect" class="w-full sm:w-auto px-3 md:px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm md:text-base">
                        <option value="">‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                        <option value="01">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
                        <option value="02">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
                        <option value="03">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
                        <option value="04">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
                        <option value="05">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
                        <option value="06">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
                        <option value="07">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
                        <option value="08">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
                        <option value="09">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
                        <option value="10">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
                        <option value="11">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
                        <option value="12">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
                    </select>
                </div>
                <button id="loadDataBtn" class="w-full sm:w-auto bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white px-6 md:px-8 py-2 md:py-3 rounded-lg font-medium transition-all duration-300 transform hover:scale-105 shadow-lg text-sm md:text-base">
                    üîç ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
            </div>
        </div>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="hidden text-center py-8">
            <div class="loading inline-block w-8 h-8 border-4 border-white border-t-transparent rounded-full"></div>
            <p class="text-white mt-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="hidden card rounded-2xl p-6 mb-8 shadow-2xl bg-red-50 border-red-200">
            <div class="text-center text-red-600">
                <p class="text-lg font-medium">‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                <p class="text-sm mt-2">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï</p>
            </div>
        </div>

        <!-- Data Display -->
        <div id="dataContainer" class="hidden fade-in">
            <!-- Summary Stats -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 md:gap-6 mb-6 md:mb-8 mx-2 md:mx-0">
                <div class="card rounded-xl md:rounded-2xl p-4 md:p-6 text-center shadow-2xl">
                    <div class="text-2xl md:text-3xl mb-2">üìÖ</div>
                    <div class="text-lg md:text-2xl font-bold text-blue-600" id="selectedMonth">‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                    <div class="text-gray-600 text-sm md:text-base">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>
                </div>
                <div class="card rounded-xl md:rounded-2xl p-4 md:p-6 text-center shadow-2xl">
                    <div class="text-2xl md:text-3xl mb-2">üìù</div>
                    <div class="text-lg md:text-2xl font-bold text-purple-600" id="totalResponses">0</div>
                    <div class="text-gray-600 text-sm md:text-base">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
            </div>

            <!-- Detailed Results -->
            <div class="space-y-4 md:space-y-6 mx-2 md:mx-0">
                <!-- Question 1 -->
                <div class="card rounded-xl md:rounded-2xl p-4 md:p-6 shadow-2xl">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-3 md:mb-4 leading-tight">üë®‚Äç‚öïÔ∏è 1. ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</h3>
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4" id="q1Results">
                        <div class="text-center p-3 md:p-4 bg-green-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-green-600" id="q1-excellent">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-blue-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-blue-600" id="q1-good">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏î‡∏µ</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-yellow-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-yellow-600" id="q1-fair">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏û‡∏≠‡πÉ‡∏ä‡πâ</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-red-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-red-600" id="q1-poor">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</div>
                        </div>
                    </div>
                </div>

                <!-- Question 2 -->
                <div class="card rounded-xl md:rounded-2xl p-4 md:p-6 shadow-2xl">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-3 md:mb-4 leading-tight">üòä 2. ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏π‡∏î‡∏à‡∏≤‡∏™‡∏∏‡∏†‡∏≤‡∏û ‡∏¢‡∏¥‡πâ‡∏°‡πÅ‡∏¢‡πâ‡∏°‡πÅ‡∏à‡πà‡∏°‡πÉ‡∏™</h3>
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4" id="q2Results">
                        <div class="text-center p-3 md:p-4 bg-green-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-green-600" id="q2-excellent">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-blue-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-blue-600" id="q2-good">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏î‡∏µ</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-yellow-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-yellow-600" id="q2-fair">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏û‡∏≠‡πÉ‡∏ä‡πâ</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-red-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-red-600" id="q2-poor">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</div>
                        </div>
                    </div>
                </div>

                <!-- Question 3 -->
                <div class="card rounded-xl md:rounded-2xl p-4 md:p-6 shadow-2xl">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-3 md:mb-4 leading-tight">‚ù§Ô∏è 3. ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏≤‡πÉ‡∏à‡πÉ‡∏™‡πà ‡πÄ‡∏ï‡πá‡∏°‡πÉ‡∏à‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h3>
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4" id="q3Results">
                        <div class="text-center p-3 md:p-4 bg-green-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-green-600" id="q3-excellent">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-blue-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-blue-600" id="q3-good">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏î‡∏µ</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-yellow-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-yellow-600" id="q3-fair">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏û‡∏≠‡πÉ‡∏ä‡πâ</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-red-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-red-600" id="q3-poor">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</div>
                        </div>
                    </div>
                </div>

                <!-- Question 4 -->
                <div class="card rounded-xl md:rounded-2xl p-4 md:p-6 shadow-2xl">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-3 md:mb-4 leading-tight">üåü 4. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°</h3>
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4" id="q4Results">
                        <div class="text-center p-3 md:p-4 bg-green-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-green-600" id="q4-excellent">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-blue-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-blue-600" id="q4-good">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏î‡∏µ</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-yellow-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-yellow-600" id="q4-fair">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏û‡∏≠‡πÉ‡∏ä‡πâ</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-red-100 rounded-lg">
                            <div class="text-xl md:text-2xl font-bold text-red-600" id="q4-poor">0</div>
                            <div class="text-xs md:text-sm text-gray-600">‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</div>
                        </div>
                    </div>
                </div>

                <!-- Popular Physiotherapists -->
                <div class="card rounded-xl md:rounded-2xl p-4 md:p-6 shadow-2xl">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-3 md:mb-4">üèÜ ‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à</h3>
                    <div id="physiotherapistList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Comments Section -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6">
                    <div class="card rounded-xl md:rounded-2xl p-4 md:p-6 shadow-2xl">
                        <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-3 md:mb-4">üí° ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</h3>
                        <div id="suggestionsList" class="space-y-2 md:space-y-3 max-h-80 md:max-h-96 overflow-y-auto">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                    <div class="card rounded-xl md:rounded-2xl p-4 md:p-6 shadow-2xl">
                        <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-3 md:mb-4">üîß ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</h3>
                        <div id="improvementsList" class="space-y-2 md:space-y-3 max-h-80 md:max-h-96 overflow-y-auto">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const APP_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx_gf0fO0cA4zboO_uQfsD68y9jHdMV9q36EOtcfoLyDuo35VAfIBIiyFi7u0fRmvz_Bg/exec';
        
        let allData = [];

        document.getElementById('loadDataBtn').addEventListener('click', loadData);

        function loadData() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            const errorMessage = document.getElementById('errorMessage');
            const dataContainer = document.getElementById('dataContainer');
            
            // Show loading, hide others
            loadingIndicator.classList.remove('hidden');
            errorMessage.classList.add('hidden');
            dataContainer.classList.add('hidden');

            // Create JSONP callback
            const callbackName = 'jsonpCallback_' + Date.now();
            window[callbackName] = function(data) {
                loadingIndicator.classList.add('hidden');
                
                if (data && data.length > 0) {
                    allData = data;
                    processAndDisplayData();
                    dataContainer.classList.remove('hidden');
                } else {
                    showError('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö');
                }
                
                // Cleanup
                delete window[callbackName];
                document.head.removeChild(script);
            };

            // Create script tag for JSONP
            const script = document.createElement('script');
            script.src = `${APP_SCRIPT_URL}?callback=${callbackName}`;
            script.onerror = function() {
                loadingIndicator.classList.add('hidden');
                showError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ');
                delete window[callbackName];
                document.head.removeChild(script);
            };
            
            document.head.appendChild(script);
        }

        function showError(message) {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.querySelector('p').textContent = message;
            errorMessage.classList.remove('hidden');
        }

        function processAndDisplayData() {
            const selectedMonth = document.getElementById('monthSelect').value;
            
            // Filter data by month if selected
            let filteredData = allData;
            if (selectedMonth) {
                filteredData = allData.filter(row => {
                    const timestamp = row[0]; // Assuming timestamp is in first column
                    if (timestamp) {
                        const date = new Date(timestamp);
                        const month = String(date.getMonth() + 1).padStart(2, '0');
                        return month === selectedMonth;
                    }
                    return false;
                });
            }

            // Process the data
            const results = {
                q1: { excellent: 0, good: 0, fair: 0, poor: 0 },
                q2: { excellent: 0, good: 0, fair: 0, poor: 0 },
                q3: { excellent: 0, good: 0, fair: 0, poor: 0 },
                q4: { excellent: 0, good: 0, fair: 0, poor: 0 },
                suggestions: [],
                improvements: [],
                physiotherapists: {}
            };

            filteredData.forEach(row => {
                // Assuming columns are: timestamp, q1, q2, q3, q4, suggestions, improvements, physiotherapist
                if (row.length >= 8) {
                    // Process questions 1-4 (columns 1-4)
                    for (let i = 1; i <= 4; i++) {
                        const answer = row[i];
                        if (answer) {
                            const qKey = `q${i}`;
                            if (answer.includes('‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°')) results[qKey].excellent++;
                            else if (answer.includes('‡∏î‡∏µ')) results[qKey].good++;
                            else if (answer.includes('‡∏û‡∏≠‡πÉ‡∏ä‡πâ')) results[qKey].fair++;
                            else if (answer.includes('‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á')) results[qKey].poor++;
                        }
                    }

                    // Process suggestions (column 5)
                    if (row[5] && row[5].trim()) {
                        results.suggestions.push(row[5].trim());
                    }

                    // Process improvements (column 6)
                    if (row[6] && row[6].trim()) {
                        results.improvements.push(row[6].trim());
                    }

                    // Process physiotherapists (column 7)
                    if (row[7] && row[7].trim()) {
                        const name = row[7].trim();
                        results.physiotherapists[name] = (results.physiotherapists[name] || 0) + 1;
                    }
                }
            });

            // Update UI
            updateSummaryStats(filteredData.length, results);
            updateQuestionResults(results);
            updatePhysiotherapistList(results.physiotherapists);
            updateComments(results.suggestions, results.improvements);
        }

        function updateSummaryStats(totalResponses, results) {
            document.getElementById('totalResponses').textContent = totalResponses;
            
            // Update selected month display
            const selectedMonth = document.getElementById('monthSelect').value;
            const monthNames = {
                '': '‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
                '01': '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°',
                '02': '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå',
                '03': '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°',
                '04': '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô',
                '05': '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°',
                '06': '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                '07': '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°',
                '08': '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°',
                '09': '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô',
                '10': '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°',
                '11': '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô',
                '12': '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
            };
            document.getElementById('selectedMonth').textContent = monthNames[selectedMonth] || '‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô';
        }

        function updateQuestionResults(results) {
            for (let i = 1; i <= 4; i++) {
                const qKey = `q${i}`;
                document.getElementById(`${qKey}-excellent`).textContent = results[qKey].excellent;
                document.getElementById(`${qKey}-good`).textContent = results[qKey].good;
                document.getElementById(`${qKey}-fair`).textContent = results[qKey].fair;
                document.getElementById(`${qKey}-poor`).textContent = results[qKey].poor;
            }
        }

        function updatePhysiotherapistList(physiotherapists) {
            const container = document.getElementById('physiotherapistList');
            container.innerHTML = '';

            // ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏ô‡∏±‡∏ö
            const physiotherapistNames = [
                '‡∏ê‡∏¥‡∏ï‡∏¥‡∏°‡∏≤ ‡∏≠‡∏∏‡∏î‡∏°‡πÄ‡∏•‡∏¥‡∏®‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå',
                '‡∏≠‡∏∏‡∏°‡∏≤‡∏û‡∏£ ‡∏≠‡∏ï‡∏¥‡∏ä‡∏≤‡∏ï‡∏¥‡∏°‡∏ì‡∏µ',
                '‡πÄ‡∏≠‡∏Å‡∏ò‡∏ô‡∏±‡∏ä ‡∏™‡∏∏‡∏£‡∏∞‡∏û‡∏á‡∏©‡πå',
                '‡∏à‡∏¥‡∏£‡∏û‡∏á‡∏®‡πå ‡∏ß‡∏á‡∏©‡πå‡πÄ‡∏ß‡∏ä',
                '‡∏ô‡∏¥‡∏™‡∏≤ ‡∏à‡∏≥‡∏õ‡∏≤‡πÅ‡∏ù‡∏î',
                '‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏≤ ‡πÇ‡∏Ñ‡πâ‡∏ß‡∏™‡∏ß‡πà‡∏≤‡∏á',
                '‡πÑ‡∏û‡πÇ‡∏£‡∏à‡∏ô‡πå ‡πÅ‡∏™‡∏á‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå',
                '‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô'
            ];

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡∏ö‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ô
            const counts = {};
            physiotherapistNames.forEach(name => {
                counts[name] = 0;
            });

            // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö
            Object.entries(physiotherapists).forEach(([inputName, count]) => {
                let matched = false;
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏î‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                physiotherapistNames.forEach(targetName => {
                    if (inputName.includes(targetName) || targetName.includes(inputName) || 
                        inputName.toLowerCase().includes(targetName.toLowerCase()) ||
                        targetName.toLowerCase().includes(inputName.toLowerCase())) {
                        counts[targetName] += count;
                        matched = true;
                    }
                });

                // ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏î‡πÄ‡∏•‡∏¢ ‡πÉ‡∏´‡πâ‡∏ô‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô "‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô"
                if (!matched && inputName.trim() !== '') {
                    counts['‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô'] += count;
                }
            });

            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
            const sortedCounts = Object.entries(counts)
                .filter(([name, count]) => count > 0)
                .sort(([,a], [,b]) => b - a);

            if (sortedCounts.length === 0) {
                container.innerHTML = '<p class="text-gray-500 col-span-full text-center">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>';
                return;
            }

            sortedCounts.forEach(([name, count], index) => {
                const item = document.createElement('div');
                item.className = 'bg-gradient-to-r from-purple-100 to-blue-100 p-3 md:p-4 rounded-lg text-center transform hover:scale-105 transition-transform duration-200';
                
                // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö
                let icon = 'üèÖ';
                if (index === 0) icon = 'ü•á';
                else if (index === 1) icon = 'ü•à';
                else if (index === 2) icon = 'ü•â';
                
                item.innerHTML = `
                    <div class="text-2xl md:text-3xl mb-2">${icon}</div>
                    <div class="font-bold text-gray-800 text-xs sm:text-sm md:text-base leading-tight">${name}</div>
                    <div class="text-xs md:text-sm text-purple-600 font-medium mt-1">${count} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                `;
                container.appendChild(item);
            });
        }

        function updateComments(suggestions, improvements) {
            updateCommentSection('suggestionsList', suggestions, 'üí°');
            updateCommentSection('improvementsList', improvements, 'üîß');
        }

        function updateCommentSection(containerId, comments, emoji) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            if (comments.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>';
                return;
            }

            comments.forEach((comment, index) => {
                const item = document.createElement('div');
                item.className = 'bg-gray-50 p-3 md:p-4 rounded-lg border-l-4 border-purple-500';
                item.innerHTML = `
                    <div class="flex items-start gap-2">
                        <span class="text-base md:text-lg flex-shrink-0">${emoji}</span>
                        <p class="text-gray-700 flex-1 text-sm md:text-base leading-relaxed">${comment}</p>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // Auto-load data on page load
        window.addEventListener('load', loadData);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9640276fb39ace9b',t:'MTc1MzMyNTg4OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
